<?xml version="1.0" encoding="utf-8" ?>
<DocumentMasterQuery>
  <add key="GetDocumentTypeByDocumentTypeId" value="SELECT DT.Id,DT.DocumentType, DT.FileSize,DT.MinImageWidth,DT.MinImageHeight,DT.MaxImageWidth,DT.MaxImageHeight FROM DMS.DocumentType DT WHERE DT.Id=@DocumentTypeId" />
  <add key="GetFileNameByDocumentId" value="SELECT  D.UploadedFileName,DV.Id DocumentVersionId,DV.[Version] FROM DMS.Document D INNER JOIN DMS.DocumentVersion DV On D.Id=DV.DocumentId where D.Id=@Id AND DV.IsActive=1 " />
  <add key="GetImageTypeWithDocumentTypeDetailsByDocumentAndDocumentTypeId" value="SELECT DT.DocumentType,IT.Id ImageTypeId,IT.TypeName,IT.Width,IT.Height,DV.Id VersionId FROM DMS.Document D INNER JOIN DMS.DocumentType DT ON DT.Id=D.DocumentTypeId INNER JOIN DMS.ImageType IT ON DT.Id=IT.DocumentTypeId INNER JOIN DMS.DocumentVersion DV ON D.Id=DV.DocumentId where  D.Id=@DocumentId and DT.Id=@DocumentTypeId"/>
  <add key="GetImageDocumentImageName" value="SELECT ImgDoc.ImageName FROM DMS.ImageDocument ImgDoc where ImgDoc.DocumentId=@DocumentId AND ImgDoc.ImageTypeId=@ImageTypeId and ImgDoc.DocumentVersionId=@DocumentVersionId" />
  <add key="UpdateImageDocument" value="UPDATE DMS.ImageDocument set ImageName=@ImageName,ModifiedBy=@ModifiedBy,Modifiedon=@Modifiedon,Width=@Width,Height=@Height where DocumentId=@DocumentId AND ImageTypeId=@ImageTypeId and DocumentVersionId=@DocumentVersionId" />
  <add key="GetDocumentList" value="SELECT D.Id DocumentId, D.Name DocumentName, D.UploadedFileName,D.CostFee, D.CreatedBy, D.ExpiredDate,D.FileSize,FilePath=(SELECT F.PhysicallFolderName FROM DMS.Folder F WHERE F.Id=D.FolderId),MIMEType=(SELECT FTM.MIMEType FROM common.FileTypeMaster FTM WHERE FTM.Id =D.BaseDocumentType), D.ImageWidth,D.ImageHeight,D.CreatedOn,D.ReviewStatus,D.AllowReviewersToReassignReview,D.NotifyInitiatorWhenReviewComplete,D.UseDefaultWorkflow,D.ReviewerInstruction,DV.DocumentVersionName ActivetedFileName FROM DMS.Document D INNER JOIN DMS.DocumentType DT ON DT.Id=D.DocumentTypeId INNER JOIN DMS.DocumentVersion DV ON D.Id=DV.DocumentId WHERE D.Id IN (SELECT CAST(Value AS INT) FROM Ids_Split(@IDs, ','))"></add>
  <add key="GetDocumentListByImageType" value="SELECT D.Id DocumentId,D.Name DocumentName, ImgDoc.ImageName UploadedFileName,D.CostFee, D.CreatedBy, D.ExpiredDate,D.FileSize,FilePath=(SELECT F.PhysicallFolderName FROM DMS.Folder F WHERE F.Id=D.FolderId),MIMEType=(SELECT FTM.MIMEType FROM common.FileTypeMaster FTM WHERE FTM.Id =D.BaseDocumentType),D.ReviewStatus,D.AllowReviewersToReassignReview,D.NotifyInitiatorWhenReviewComplete,D.UseDefaultWorkflow,D.ReviewerInstruction FROM DMS.Document D INNER JOIN DMS.DocumentType DT ON DT.Id=D.DocumentTypeId INNER JOIN DMS.ImageType IT ON DT.Id=IT.DocumentTypeId INNER JOIN DMS.ImageDocument ImgDoc ON IT.Id=ImgDoc.ImageTypeId WHERE IT.TypeName=@ImagetTypeName and D.Id=ImgDoc.DocumentId and D.Id IN(SELECT CAST(Value AS INT) FROM Ids_Split(@IDs, ','))"/>
  <add key="GetDocumentListByImageTypeList" value="SELECT D.Id DocumentId,D.Name DocumentName, D.UploadedFileName,D.CostFee, D.CreatedBy, D.ExpiredDate,D.FileSize,FilePath=(SELECT F.PhysicallFolderName FROM DMS.Folder F WHERE F.Id=D.FolderId),MIMEType=(SELECT FTM.MIMEType FROM common.FileTypeMaster FTM WHERE FTM.Id =D.BaseDocumentType),IT.Width,IT.Height,DT.Code,IT.Id ImageTypeId, D.ReviewStatus,D.AllowReviewersToReassignReview,D.NotifyInitiatorWhenReviewComplete,D.UseDefaultWorkflow,D.ReviewerInstruction FROM DMS.Document D INNER JOIN DMS.DocumentType DT ON DT.Id=D.DocumentTypeId INNER JOIN DMS.ImageType IT ON DT.Id=IT.DocumentTypeId WHERE IT.TypeName IN(SELECT Value FROM Ids_Split(@ImagetTypeName,',')) and D.Id=@DocumentId"/>
  <add key="GetDocumentImageByDocumentId" value="SELECT D.Id DocumentId,D.Name DocumentName, D.UploadedFileName,D.CostFee, D.CreatedBy, D.ExpiredDate,D.FileSize,FilePath=(SELECT F.PhysicallFolderName FROM DMS.Folder F WHERE F.Id=D.FolderId),MIMEType=(SELECT FTM.MIMEType FROM common.FileTypeMaster FTM WHERE FTM.Id =D.BaseDocumentType),DT.Code,DT.MinImageWidth,DT.MinImageHeight,DT.MaxImageWidth,DT.MaxImageHeight FROM DMS.Document D INNER JOIN DMS.DocumentType DT ON DT.Id=D.DocumentTypeId where D.Id=@DocumentId" />
  <add key="GetDocumentTypeByCode" value="SELECT TOP 1 Id FROM DMS.DocumentType WHERE Code=@Code"/>
  <add key="UpdateDocumentVersion" value="UPDATE DMS.DocumentVersion SET DocumentVersionName=@DocumentVersionName,ModifiedBy=@ModifiedBy,Modifiedon=@Modifiedon OUTPUT INSERTED.Id WHERE DocumentId=@DocumentId AND IsActive=1" />
  <add key="GetFolderIdByCode" value="SELECT F.Id from DMS.Folder F WHERE F.FolderCode=@FolderCode" />
  <add key="GetFolderNameById" value="SELECT F.Id,F.PhysicallFolderName from DMS.Folder F WHERE F.Id=@Id" />
  <add key="GetImageTypeWithDocumentTypeDetailsByDocumentTypeId" value="SELECT DT.DocumentType,IT.Id ImageTypeId,IT.TypeName,IT.Width,IT.Height FROM DMS.DocumentType DT INNER JOIN DMS.ImageType IT ON DT.Id=IT.DocumentTypeId where DT.Id=@DocumentTypeId"/>
  <add key="AddImageDocument" value="INSERT INTO DMS.ImageDocument(DocumentId,ImageName,ImageTypeId,DocumentVersionId,CreatedBy,CreatedOn,Width,Height)VALUES(@DocumentId,@ImageName,@ImageTypeId,@DocumentVersionId,@CreatedBy,@CreatedOn,@Width,@Height);SELECT SCOPE_IDENTITY();" />
  <add key="SaveAsAddDocumentVersion" value="INSERT INTO [DMS].[DocumentVersion]([DocumentId],[Version],DocumentVersionName,[IsActive],[CreatedBy],[CreatedOn],Tid)VALUES(@DocumentId,@Version,@DocumentVersionName,@IsActive,@CreatedBy,@CreatedOn,(select D.Id from DMS.Document D where D.Id=@oldDocumentId));SELECT SCOPE_IDENTITY();"></add>
  <add key="ActiveCurrentVerion" value="UPDATE DMS.DocumentVersion SET IsActive=0 WHERE DocumentId=@DocumentId;UPDATE DMS.DocumentVersion SET IsActive=1 WHERE Id=@Id" />
  <add key="AddDocument" value="INSERT INTO [DMS].[Document]([DocumentTypeId],[Name],[UploadedFileName],[BaseDocumentType],[Title],[DocumentSubject],[Keywords],[DocumentNumber],[Comment],[CostFee],[ExpiredDate] ,[CreatedBy],[CreatedOn],[FileSize],ParentId,ImageWidth,ImageHeight,FolderId,ReviewStatus,AllowReviewersToReassignReview,NotifyInitiatorWhenReviewComplete,UseDefaultWorkflow,ReviewerInstruction)VALUES(@DocumentTypeId,@Name,@UploadedFileName,@BaseDocumentType,@Title,@DocumentSubject,@Keywords,@DocumentNumber,@Comment,@CostFee,@ExpiredDate,@CreatedBy,@CreatedOn,@FileSize,@ParentId,@ImageWidth,@ImageHeight,@FolderId,@ReviewStatus,@AllowReviewersToReassignReview,@NotifyInitiatorWhenReviewComplete,@UseDefaultWorkflow,@ReviewerInstruction);SELECT SCOPE_IDENTITY();"></add>
  <add key="AddDocumentVersion" value="INSERT INTO [DMS].[DocumentVersion]([DocumentId],[Version],DocumentVersionName,[IsActive],[CreatedBy],[CreatedOn])VALUES(@DocumentId,@Version,@DocumentVersionName,@IsActive,@CreatedBy,@CreatedOn);SELECT SCOPE_IDENTITY();"></add>
  <add key="CheckIsImage" value="SELECT COUNT(*) TotalCount FROM DMS.ImageType WHERE DocumentTypeId=@DocumentTypeId" />
  <add key="UpdateImageProperties" value="update DMS.Document set ImageWidth=@width,ImageHeight=@height where Id=@Id"></add>
</DocumentMasterQuery>